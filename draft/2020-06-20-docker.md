---
layout: post
title: windows安装docker
category: interview
---







### 一、下载安装 Docker for Windows 

 Windows安装文件：http://mirrors.aliyun.com/docker-toolbox/windows/docker-for-windows/ 



#### 测试Docker版本

成功安装Docker Desktop后，cmd中（安装git的最好在Git bash中）输入docker --version，打印出版本信息，表示Docker for Windows安装成功。

### 测试Docker安装

1. 通过运行[hello-world](https://hub.docker.com/_/hello-world/) Docker映像来测试安装是否正常：

   ```shell
       $ docker run hello-world
   
       Unable to find image 'hello-world:latest' locally
       latest: Pulling from library/hello-world
       ca4f61b1923c: Pull complete
       Digest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7
       Status: Downloaded newer image for hello-world:latest
   
       Hello from Docker!
       This message shows that your installation appears to be working correctly.
       ...
   ```

2. 运行`docker image ls`以列出`hello-world`您下载到计算机上的映像。

3. 列出`hello-world`显示消息后退出的容器（由图像生成）。如果它仍在运行，则不需要以下`--all`选项：

   ```shell
       $ docker ps --all
   
       CONTAINER ID     IMAGE           COMMAND      CREATED            STATUS
       54f4984ed6a8     hello-world     "/hello"     20 seconds ago     Exited (0) 19 seconds ago
   ```

 至此，您已经在开发机器上安装了Docker Desktop，并进行了快速测试，以确保您已设置为构建和运行第一个容器化应用程序。 

# 生成并运行图像

### Git的

如果您使用的是Git，则可以从GitHub克隆示例项目：

```
git clone https://github.com/dockersamples/node-bulletin-board
cd node-bulletin-board/bulletin-board-app
```

------

## 定义与Dockerfile容器

下载项目后，查看`Dockerfile`公告板应用程序中调用的文件。Dockerfile描述了如何为容器组装私有文件系统，并且还可以包含一些元数据，这些元数据描述了如何基于该映像运行容器。

有关在公告板应用程序中使用的Dockerfile的更多信息，请参见[Sample Dockerfile](https://docs.docker.com/get-started/part2/#sample-dockerfile)。

## 建立并测试您的形象

现在您已经有了一些源代码和一个Dockerfile，现在该构建您的第一个映像，并确保从其启动的容器能够按预期工作。

`node-bulletin-board/bulletin-board-app`使用`cd`命令确保您位于终端或PowerShell 中的目录中。运行以下命令来构建公告板图像：

```script
docker build --tag bulletinboard:1.0 .
```

您将看到Docker逐步完成Dockerfile中的每条指令，逐步构建映像。如果成功，则构建过程应以message结束`Successfully tagged bulletinboard:1.0`。

> **Windows用户：**
>
> 本示例使用Linux容器。右键单击系统托盘中的Docker徽标，然后单击**切换到Linux容器**，**以**确保您的环境正在运行**Linux容器**。不用担心-本教程中的所有命令对于Windows容器的工作方式都完全相同。
>
> 运行映像后，您可能会收到一条标题为“ SECURITY WARNING”（安全警告）的消息，说明为添加到映像中的文件设置了读取，写入和执行权限。在此示例中，我们不处理任何敏感信息，因此在此示例中，请不要理会警告。

## 将图像作为容器运行

1. 运行以下命令以基于新映像启动容器：

   ```script
   docker run --publish 8000:8080 --detach --name bb bulletinboard:1.0
   ```

   这里有几个常见的标志：

   - `--publish`要求Docker将主机端口8000上传入的流量转发到容器的端口8080。容器具有自己的专用端口集，因此，如果要从网络访问某个端口，则必须以这种方式将流量转发到该端口。否则，作为默认的安全状态，防火墙规则将阻止所有网络流量到达您的容器。
   - `--detach` 要求Docker在后台运行此容器。
   - `--name`指定一个名称，在后续命令中，您可以使用该名称来引用您的容器`bb`。

2. 在的浏览器中访问您的应用程序`localhost:8000`。您应该看到公告板应用程序已启动并正在运行。在这一步，您通常会尽一切可能确保容器按预期方式工作。例如，现在是运行单元测试的时候了。

3. 对公告板容器正常工作感到满意后，可以将其删除：

   ```script
   docker rm --force bb
   ```

   该`--force`选件停止正在运行的容器，因此可以将其删除。如果先停止运行该容器`docker stop bb`，则无需使用`--force`来删除它。

## 结论

至此，您已经成功构建了映像，对应用程序进行了简单的容器化，并确认您的应用程序已在其容器中成功运行。下一步将在[Docker Hub](https://hub.docker.com/)上共享您的映像，以便可以轻松下载它们并在任何目标计算机上运行它们。



# 在Docker Hub上共享图像

开发容器化应用程序的最后一步是在[Docker Hub之](https://hub.docker.com/)类的注册表上共享图像，以便可以轻松下载它们并在任何目标计算机上运行它们。

## 设置您的Docker Hub帐户

如果您没有Docker ID，请按照以下步骤创建一个。Docker ID可让您在Docker Hub上共享映像。

1. 访问[Docker Hub注册](https://hub.docker.com/signup)页面。

2. 填写表格并提交以创建您的Docker ID。

3. 验证您的电子邮件地址以完成注册过程。

4. 点击工具栏或系统托盘中的Docker图标，然后点击**登录/创建Docker ID**。

5. 填写新的Docker ID和密码。成功通过身份验证后，您的Docker ID将显示在Docker Desktop菜单中，代替您刚使用的“登录”选项。

   您还可以通过输入从命令行登录Docker Hub `docker login`。

## 创建一个Docker Hub存储库并推送您的映像

> 在创建存储库之前，请确保已设置Docker Hub帐户并将其连接到Docker桌面。

现在，让我们创建您的第一个存储库，并将您的公告板映像推送到Docker Hub。

1. 单击菜单栏中的Docker图标，然后导航至**存储库>创建**。您将被重定向到Docker Hub上的**Create Repository**页面。

2. 输入存储库名称为`bulletinboard`，然后单击页面底部的**创建**。现在不要填写任何其他详细信息。

   ![进行回购](https://docs.docker.com/get-started/images/newrepo.png)

3. 您现在可以在Docker Hub上共享映像了，但是，您必须首先做一件事：必须*正确命名*映像的*名称*才能在Docker Hub上共享。具体来说，您必须将图像命名为`/:`。

   确保您位于`node-bulletin-board/bulletin-board-app`终端或PowerShell 中的目录中，然后运行：

   ```
   docker tag bulletinboard:1.0 <Your Docker ID>/bulletinboard:1.0
   ```

4. 最后，将映像推送到Docker Hub：

   ```
   docker push <Your Docker ID>/bulletinboard:1.0
   ```

   在[Docker Hub中](https://hub.docker.com/repositories)访问您的存储库，您将在此处看到新映像。请记住，默认情况下，Docker Hub存储库是公共的。

   > **推送有困难吗？**请记住，您必须通过Docker Desktop或命令行登录Docker Hub，并且还必须按照上述步骤正确命名映像。如果该推送似乎有效，但您在Docker Hub中看不到它，请在几分钟后刷新浏览器，然后再次检查。

## 结论

现在，您的映像已在Docker Hub上可用，您将可以在任何地方运行它。如果您尝试在尚未安装的新机器上使用它，则Docker将自动尝试从Docker Hub下载它。通过以这种方式移动映像，您不再需要在要运行软件的计算机上安装除Docker以外的任何依赖项。容器化应用程序的依赖关系已完全封装并隔离在映像中，您可以如上所述使用Docker Hub进行共享。

需要记住的另一件事：目前，您仅将映像推送到Docker Hub；那你的Dockerfile呢？一个关键的最佳实践是将它们保留在版本控制中，或者与应用程序的源代码一起保留。您可以在Docker Hub存储库描述中添加链接或注释，以指示可以在何处找到这些文件，不仅保留有关图像构建方式以及作为完整应用程序运行的方式的记录。





### 配置远程访问

打开`docker`的设置界面，找到`General`,在里面找到`Expose daemon on tcp://localhost:2375 without TLS`选项，打上勾，即可进行本地或远程API调用。

![img](https:////upload-images.jianshu.io/upload_images/9264166-0b03a9b7618a678a.png?imageMogr2/auto-orient/strip|imageView2/2/w/812/format/webp)

idea安装docker插件

### 配置连接

重启完成后，我们打开`settings`可以看到`docker`

![img](https:////upload-images.jianshu.io/upload_images/9264166-f23824f0276df35f.png?imageMogr2/auto-orient/strip|imageView2/2/w/1152/format/webp)

4.png

点击`+`，添加一个连接。

![img](https:////upload-images.jianshu.io/upload_images/9264166-0b7c809d4afb11db.png?imageMogr2/auto-orient/strip|imageView2/2/w/1159/format/webp)

5.png

我们通过tcp的方式连接到`linux`或者`windows`的`docker`服务。信息配置好后，`idea`会自动检测。然后会输出`connection successful`。

## idea上运行docker项目

然后配置`docker`启动项
选择编辑：

![img](https://upload-images.jianshu.io/upload_images/9264166-6426456d6f0d941d.png?imageMogr2/auto-orient/strip|imageView2/2/w/395/format/webp)

12.png

添加一个启动项：

![img](https://upload-images.jianshu.io/upload_images/9264166-b9e3ad840b0fbe64.png?imageMogr2/auto-orient/strip|imageView2/2/w/490/format/webp)

![1592646208038](C:\Users\wangjs5\AppData\Roaming\Typora\typora-user-images\1592646208038.png)

